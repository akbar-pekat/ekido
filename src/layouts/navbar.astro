---
import "../styles/navbar.css";
import Button from "../components/button.astro";
---

<nav>
  <div class="navContainer">
    <a class="navLogo" href="/#videosSection">
      <img src="/logo2-svg.svg" alt="Logo Ekido" />
    </a>
    <div class="hamburger">
      <span></span>
      <span></span>
    </div>
    <div class="navMenu">
      <a href="/#jasakami" class="menuItem">Jasa Kami</a>
      <a href="/#kenapaekido" class="menuItem">Kenapa Ekido?</a>
      <a href="/#testimoni" class="menuItem">Testimoni</a>
      <a href="/#tentangekido" class="menuItem">Tentang Ekido</a>
      <div class="mobileButton">
        <Button href="http://wa.link/2d3uae" color="yellow">
          Hubungi Kami
        </Button>
      </div>
    </div>
    <Button
      href="http://wa.link/2d3uae"
      color="yellow"
      showWhatsappIcon
      scaleOnHover
    >
      Hubungi Kami
    </Button>
  </div>
</nav>
<div class="overlay"></div>

<script>
  const SELECTORS = {
    HAMBURGER: ".hamburger",
    NAV_MENU: ".navMenu",
    OVERLAY: ".overlay",
    MENU_ITEM: ".menuItem",
  };
  const CLASSES = {
    ACTIVE: "active",
    NO_SCROLL: "no-scroll",
  };

  document.addEventListener("DOMContentLoaded", initMenu);

  function initMenu() {
    const hamburger = document.querySelector(SELECTORS.HAMBURGER);
    const navMenu = document.querySelector(SELECTORS.NAV_MENU);
    const overlay = document.querySelector(SELECTORS.OVERLAY);

    if (!hamburger || !navMenu || !overlay) return;

    hamburger.addEventListener("click", toggleMenu);
    overlay.addEventListener("click", toggleMenu);

    navMenu.addEventListener("click", (e: Event) =>
      onNavMenuClick(e as MouseEvent)
    );
  }

  function toggleMenu() {
    document
      .querySelector(SELECTORS.HAMBURGER)
      ?.classList.toggle(CLASSES.ACTIVE);
    document
      .querySelector(SELECTORS.NAV_MENU)
      ?.classList.toggle(CLASSES.ACTIVE);
    document.querySelector(SELECTORS.OVERLAY)?.classList.toggle(CLASSES.ACTIVE);
    document.body.classList.toggle(CLASSES.NO_SCROLL);
  }

  /**
   * Handles clicks inside the navMenu:
   * if a .menuItem (or its child) was clicked, close the menu.
   * @param {MouseEvent} event - The click event object
   */
  function onNavMenuClick(event: MouseEvent) {
    if ((event.target as Element)?.closest(SELECTORS.MENU_ITEM)) {
      closeMenu();
    }
  }

  function closeMenu() {
    document
      .querySelector(SELECTORS.HAMBURGER)
      ?.classList.remove(CLASSES.ACTIVE);
    document
      .querySelector(SELECTORS.NAV_MENU)
      ?.classList.remove(CLASSES.ACTIVE);
    document.querySelector(SELECTORS.OVERLAY)?.classList.remove(CLASSES.ACTIVE);
    document.body.classList.remove(CLASSES.NO_SCROLL);
  }
</script>
